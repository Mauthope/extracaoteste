<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário com Dados da Planilha</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input {
      width: 100%;
      padding: 5px;
      box-sizing: border-box;
    }
    #message {
      margin-top: 20px;
      padding: 10px;
      background-color: #e6f7e6;
      border: 1px solid #4CAF50;
      display: none;
    }
  </style>
</head>
<body>
  <h1>Carregar Planilha e Preencher Formulário</h1>

  <input type="file" id="upload" accept=".xlsx">
  <button id="process">Carregar Dados</button>

  <form id="propriedadeForm">
    <div>
      <label for="nomePropriedade">Cliente:</label>
      <input type="text" id="nomePropriedade" name="nomePropriedade">
    </div>
    <div>
      <label for="dataVisita">Data de entrada:</label>
      <input type="text" id="dataVisita" name="dataVisita">
    </div>
    <div>
      <label for="producaoLeite">Código de Barras (L):</label>
      <input type="text" id="producaoLeite" name="producaoLeite">
    </div>
    <div>
      <label for="vacasLactacao">Descrição:</label>
      <input type="text" id="vacasLactacao" name="vacasLactacao">
    </div>
    <div>
      <label for="quantPrimiparas">MS(%):</label>
      <input type="text" id="quantPrimiparas" name="quantPrimiparas">
    </div>
    <div>
      <label for="mediaLeite">Umidade (%):</label>
      <input type="text" id="mediaLeite" name="mediaLeite">
    </div>
    <div>
      <label for="lote1">FDA (%):</label>
      <input type="text" id="lote1" name="lote1">
    </div>
    <div>
      <label for="lote2">FDNmo (%):</label>
      <input type="text" id="lote2" name="lote2">
    </div>
    <div>
      <label for="lote3">Lignina (%):</label>
      <input type="text" id="lote3" name="lote3">
    </div>
    <div>
      <label for="delMedio">Amido (%):</label>
      <input type="text" id="delMedio" name="delMedio">
    </div>
    <div>
      <label for="tmrComposicao">Proteína Bruta (%):</label>
      <input type="text" id="tmrComposicao" name="tmrComposicao">
    </div>
    <div>
      <label for="kgSilagem">PIDA (%):</label>
      <input type="text" id="kgSilagem" name="kgSilagem">
    </div>
    <div>
      <label for="kgFeno">PIDN (%):</label>
      <input type="text" id="kgFeno" name="kgFeno">
    </div>
    <div>
      <label for="kgPreSecado">Proteína Solúvel (%):</label>
      <input type="text" id="kgPreSecado" name="kgPreSecado">
    </div>
    <div>
      <label for="kgRacao">EE (%):</label>
      <input type="text" id="kgRacao" name="kgRacao">
    </div>
    <div>
      <label for="sobrasCoxo">Cinzas (%):</label>
      <input type="text" id="sobrasCoxo" name="sobrasCoxo">
    </div>
    <div>
      <label for="tempoSilagem">pH:</label>
      <input type="text" id="tempoSilagem" name="tempoSilagem">
    </div>
    <div>
      <label for="vacasPreParto">Ácido Láctico (%):</label>
      <input type="text" id="vacasPreParto" name="vacasPreParto">
    </div>
    <div>
      <label for="dietaPreParto">Ácido Acético (%):</label>
      <input type="text" id="dietaPreParto" name="dietaPreParto">
    </div>
    <div>
      <label for="escoreCocho">Ácido Butírico (%):</label>
      <input type="text" id="escoreCocho" name="escoreCocho">
    </div>
    <div>
      <label for="escoreCorporal">dFDNp 48h (%):</label>
      <input type="text" id="escoreCorporal" name="escoreCorporal">
    </div>
    <div>
      <label for="uFDN240h">uFDN 240h (%):</label>
      <input type="text" id="uFDN240h" name="uFDN240h">
    </div>
    <div>
      <label for="dig">Dig. In Situ Amido (%):</label>
      <input type="text" id="dig" name="dig">
    </div>
    <div>
      <label for="kd">Kd FDN (%/h):</label>
      <input type="text" id="kd" name="kd">
    </div>
    <div>
      <label for="kda">Kd Amido (%/h):</label>
      <input type="text" id="kda" name="kda">
    </div>
    <div>
      <label for="ndt">NDT (%):</label>
      <input type="text" id="ndt" name="ndt">
    </div>
    <div>
      <label for="milk">Milk/Ton (kg):</label>
      <input type="text" id="milk" name="milk">
    </div>
  </form>

  <div id="message"></div>

  <script>
    document.getElementById('process').addEventListener('click', () => {
      const fileInput = document.getElementById('upload');
      const file = fileInput.files[0];
      const messageElement = document.getElementById('message');

      if (!file) {
        alert('Por favor, selecione uma planilha.');
        return;
      }

      const reader = new FileReader();
      reader.onload = (event) => {
        try {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          const sheetName = workbook.SheetNames[0];
          const sheet = workbook.Sheets[sheetName];

          // Mapeamento das células para os campos do formulário
          const mapping = {
            'A6': 'nomePropriedade',
            'F6': 'dataVisita',
            'H6': 'producaoLeite',
            'I6': 'vacasLactacao',
            'CN6': 'quantPrimiparas',
            'CO6': 'mediaLeite',
            'CP6': 'lote1',
            'CR6': 'lote2',
            'CS6': 'lote3',
            'CT6': 'delMedio',
            'DA6': 'tmrComposicao',
            'DD6': 'kgSilagem',
            'DE6': 'kgFeno',
            'DI6': 'kgPreSecado',
            'DQ6': 'kgRacao',
            'EG6': 'sobrasCoxo',
            'EM6': 'tempoSilagem',
            'EN6': 'vacasPreParto',
            'EO6': 'dietaPreParto',
            'EP6': 'escoreCocho',
            'FB6': 'escoreCorporal',
            'FL6': 'uFDN240h',
            'FV6': 'dig',
            'FY6': 'kd',
            'FZ6': 'kda',
            'GE6': 'ndt',
            'GF6': 'milk'
          };

          for (const [cell, fieldId] of Object.entries(mapping)) {
            const cellValue = sheet[cell]?.v;
            const field = document.getElementById(fieldId);

            if (field && cellValue !== undefined) {
              field.value = cellValue;
            }
          }

          messageElement.textContent = 'Dados carregados na íntegra da planilha!';
          messageElement.style.display = 'block';
        } catch (error) {
          console.error('Erro ao processar a planilha:', error);
          alert('Ocorreu um erro ao processar a planilha. Verifique o arquivo e tente novamente.');
        }
      };

      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>

